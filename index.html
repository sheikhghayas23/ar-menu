<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<title>Pro AR Spatial Menu - Steam Edition</title>

<style>
  :root { --accent: #00ffcc; --glass: rgba(0,0,0,0.8); }
  body { margin: 0; overflow: hidden; font-family: sans-serif; background: #000; color: #fff; }
  
  video { position: fixed; inset: 0; width: 100vw; height: 100vh; object-fit: cover; z-index: 1; }

  /* 3D Scene */
  #viewport { position: fixed; inset: 0; z-index: 2; perspective: 1200px; pointer-events: none; }
  #world { position: absolute; width: 100%; height: 100%; transform-style: preserve-3d; }

  .spatial-node {
    position: absolute; left: 50%; top: 50%;
    transform-style: preserve-3d;
    display: flex; flex-direction: column; align-items: center;
  }

  /* The Plate Area */
  .dish-wrapper { 
    position: relative; 
    transform-style: preserve-3d; 
    transform: rotateX(-20deg); /* Tilts the plate to look like it's on a table */
  }

  .food-img {
    width: 280px; height: 280px; object-fit: cover;
    border-radius: 50%; border: 10px solid #fff;
    box-shadow: 0 40px 100px rgba(0,0,0,0.9);
  }

  /* REAL STEAM EFFECT */
  .steam-container {
    position: absolute; top: -60px; left: 50%;
    transform: translateX(-50%);
    width: 100px; height: 150px;
    pointer-events: none;
  }

  .steam-cloud {
    position: absolute; bottom: 0; left: 50%;
    width: 40px; height: 40px;
    background: rgba(255, 255, 255, 0.4);
    filter: blur(15px); border-radius: 50%;
    animation: steamRise 2.5s infinite ease-out;
    opacity: 0;
  }
  .steam-cloud:nth-child(2) { animation-delay: 0.8s; left: 40%; }
  .steam-cloud:nth-child(3) { animation-delay: 1.6s; left: 60%; }

  @keyframes steamRise {
    0% { transform: translateY(0) scale(1); opacity: 0; }
    20% { opacity: 0.5; }
    100% { transform: translateY(-120px) scale(4); opacity: 0; }
  }

  /* UI Styling */
  #ui {
    position: fixed; bottom: 0; width: 100%; z-index: 10;
    background: linear-gradient(to top, #000 80%, transparent);
    padding: 20px 0 40px;
  }

  .carousel { display: flex; gap: 15px; overflow-x: auto; padding: 0 20px; scrollbar-width: none; }
  .carousel::-webkit-scrollbar { display: none; }

  .card {
    min-width: 120px; padding: 15px; background: var(--glass);
    border: 2px solid rgba(255,255,255,0.1); border-radius: 20px;
    text-align: center; transition: 0.3s;
  }
  .card.active { border-color: var(--accent); transform: scale(1.05); }

  .price-tag { color: var(--accent); font-weight: bold; font-size: 14px; margin-top: 5px; }

  /* Header Cart */
  .header {
    position: fixed; top: 20px; width: 90%; left: 5%;
    display: flex; justify-content: space-between; z-index: 100;
  }
  .bill-box { 
    background: var(--accent); color: #000; 
    padding: 10px 20px; border-radius: 50px; font-weight: 900; 
  }
  #reset-btn { background: #ff4444; color: #fff; border: none; padding: 10px 20px; border-radius: 15px; font-weight: bold; }
</style>
</head>
<body>

<video id="camera" autoplay playsinline></video>

<div class="header">
  <button id="reset-btn" onclick="clearSpace()">RESET</button>
  <div class="bill-box">Total: $<span id="total-price">0</span></div>
</div>

<div id="viewport">
  <div id="world"></div>
</div>

<div id="ui">
  <div class="carousel" id="menu"></div>
  <p style="text-align:center; font-size:12px; color:var(--accent); margin-top:10px;">TAP TO SERVE HOT FOOD</p>
</div>

<script>
const items = [
  { name: 'Biryani', price: 15, img: 'https://media.istockphoto.com/id/501150349/photo/chicken-biryani-11.jpg?s=612x612&w=0&k=20&c=w6mDnUx8MnH3rnP9bR0VfWRwrODcbTz-6U07o3Zrs4o=' },
  { name: 'Pizza', price: 12, img: 'https://images.unsplash.com/photo-1513104890138-7c749659a591?w=500' },
  { name: 'Butter Chicken', price: 18, img: 'https://images.unsplash.com/photo-1603894584115-f73f2ecb4f08?w=500' },
  { name: 'Burger', price: 10, img: 'https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=500' },
  { name: 'Sushi', price: 22, img: 'https://images.unsplash.com/photo-1579871494447-9811cf80d66c?w=500' }
];

let selected = items[0];
let total = 0;
let curA = 0, curB = 0;
let placedNodes = [];
const world = document.getElementById('world');

// Camera
navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } })
  .then(s => document.getElementById('camera').srcObject = s);

// Build Menu
const menu = document.getElementById('menu');
items.forEach((item, i) => {
  const c = document.createElement('div');
  c.className = `card ${i===0?'active':''}`;
  c.innerHTML = `<div>${item.name}</div><div class="price-tag">$${item.price}</div>`;
  c.onclick = (e) => {
    e.stopPropagation();
    document.querySelectorAll('.card').forEach(x => x.classList.remove('active'));
    c.classList.add('active');
    selected = item;
  };
  menu.appendChild(c);
});

// Sensors
window.addEventListener('deviceorientation', (e) => {
  curA = e.alpha || 0;
  curB = e.beta || 0;
  world.style.transform = `rotateX(${curB - 90}deg) rotateZ(${-curA}deg)`;
});

// Place Food
window.addEventListener('click', (e) => {
  if (e.target.closest('#ui') || e.target.closest('.header')) return;

  let targetA = curA;
  let targetB = curB;
  
  // Anti-Overlap
  placedNodes.forEach(p => {
    if (Math.abs(p.a - targetA) < 15) { targetA += 20; }
  });
  placedNodes.push({a: targetA, b: targetB});

  const node = document.createElement('div');
  node.className = 'spatial-node';
  node.style.transform = `rotateZ(${targetA}deg) rotateX(${-targetB + 90}deg) translateZ(800px)`;

  node.innerHTML = `
    <div class="dish-wrapper">
      <div class="steam-container">
        <div class="steam-cloud"></div>
        <div class="steam-cloud"></div>
        <div class="steam-cloud"></div>
      </div>
      <img src="${selected.img}" class="food-img">
      <div style="background:rgba(0,0,0,0.8); padding:5px 15px; border-radius:20px; margin-top:10px; text-align:center;">
        <b>${selected.name}</b>
      </div>
    </div>
  `;

  world.appendChild(node);
  
  total += selected.price;
  document.getElementById('total-price').innerText = total;
  if(navigator.vibrate) navigator.vibrate(50);
});

function clearSpace() {
  world.innerHTML = '';
  placedNodes = [];
  total = 0;
  document.getElementById('total-price').innerText = total;
}
</script>
</body>
</html>
