<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<title>Spatial Culinary AR</title>

<style>
  :root {
    --accent: #00ffcc;
    --glass: rgba(20, 20, 20, 0.85);
  }

  body { margin: 0; overflow: hidden; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto; background: #000; color: white; }
  
  video { position: fixed; inset: 0; width: 100vw; height: 100vh; object-fit: cover; z-index: 1; }

  /* The 3D Stage */
  #ar-world {
    position: fixed;
    inset: 0;
    z-index: 2;
    pointer-events: none;
    perspective: 1200px;
    transform-style: preserve-3d;
  }

  .dish-container {
    position: absolute;
    transform-style: preserve-3d;
    transition: opacity 0.6s cubic-bezier(0.23, 1, 0.32, 1);
  }

  .placed-dish {
    width: 220px;
    height: auto;
    filter: drop-shadow(0 10px 15px rgba(0,0,0,0.5));
    animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }

  /* Real-world shadow effect */
  .dish-shadow {
    position: absolute;
    bottom: -10px;
    left: 50%;
    width: 180px;
    height: 40px;
    background: radial-gradient(ellipse at center, rgba(0,0,0,0.6) 0%, rgba(0,0,0,0) 70%);
    transform: translateX(-50%) rotateX(90deg);
    z-index: -1;
  }

  @keyframes popIn {
    0% { transform: scale(0) translateZ(-200px); opacity: 0; }
    100% { transform: scale(1) translateZ(0); opacity: 1; }
  }

  /* Measurement-Style Reticle */
  #reticle {
    position: fixed;
    left: 50%; top: 50%;
    transform: translate(-50%, -50%);
    width: 44px; height: 44px;
    border: 1.5px solid white;
    border-radius: 50%;
    z-index: 4;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 0 15px rgba(0,0,0,0.3);
    transition: all 0.2s ease;
  }
  #reticle::before { content: ''; width: 100%; height: 1.5px; background: rgba(255,255,255,0.3); position: absolute; }
  #reticle::after { content: ''; width: 1.5px; height: 100%; background: rgba(255,255,255,0.3); position: absolute; }

  /* UI Styling */
  #ui-top {
    position: fixed; top: 0; width: 100%; padding: 20px;
    display: flex; justify-content: space-between; align-items: flex-start; z-index: 10;
  }

  .glass-btn {
    background: var(--glass);
    border: 1px solid rgba(255,255,255,0.1);
    backdrop-filter: blur(10px);
    color: white; padding: 10px 18px; border-radius: 12px;
    font-size: 14px; font-weight: 600; cursor: pointer;
  }

  #ui-bottom {
    position: fixed; bottom: 0; width: 100%;
    background: linear-gradient(to top, rgba(0,0,0,0.95) 0%, rgba(0,0,0,0.8) 70%, transparent 100%);
    z-index: 10; padding-bottom: 30px;
  }

  .carousel { 
    display: flex; gap: 15px; overflow-x: auto; padding: 20px;
    scroll-snap-type: x mandatory; scrollbar-width: none;
  }
  .carousel::-webkit-scrollbar { display: none; }

  .food-card {
    min-width: 110px; padding: 15px;
    background: rgba(255,255,255,0.05);
    border-radius: 18px; border: 1px solid rgba(255,255,255,0.1);
    text-align: center; scroll-snap-align: center;
    transition: all 0.3s ease;
  }
  .food-card.active { 
    background: var(--accent); color: #000;
    transform: translateY(-5px); border-color: white;
  }

  .stats { font-size: 10px; opacity: 0.6; margin-top: 5px; text-transform: uppercase; }

  /* Size Slider */
  #controls { padding: 0 20px; display: flex; align-items: center; gap: 15px; color: #fff; font-size: 12px; }
  input[type=range] { flex: 1; accent-color: var(--accent); }
</style>
</head>
<body>

<video id="camera" autoplay playsinline></video>

<div id="ui-top">
  <div class="glass-btn">Spatial Menu v2.0</div>
  <button class="glass-btn" style="color: #ff4d4d;" onclick="clearWorld()">Reset Space</button>
</div>

<div id="ar-world"></div>
<div id="reticle"></div>

<div id="ui-bottom">
  <div id="controls">
    <span>SMALL</span>
    <input type="range" id="sizeSlider" min="100" max="400" value="220">
    <span>LARGE</span>
  </div>
  
  <div class="carousel" id="menu"></div>
  <div style="text-align:center; font-size:11px; color:rgba(255,255,255,0.5); letter-spacing:1px;">
    TAP ANYWHERE TO PLACE DISH
  </div>
</div>

<script>
const menuItems = [
  { name: 'Biryani', icon: 'ðŸ›', img: 'https://media.istockphoto.com/id/501150349/photo/chicken-biryani-11.jpg?s=612x612&w=0&k=20&c=w6mDnUx8MnH3rnP9bR0VfWRwrODcbTz-6U07o3Zrs4o=' },
  { name: 'Pizza', icon: 'ðŸ•', img: 'https://img.freepik.com/free-psd/delicious-pepperoni-pizza-culinary-delight_632498-24206.jpg?w=740' },
  { name: 'Lasagna', icon: 'ðŸ', img: 'https://static1.squarespace.com/static/5ed666a6924cd0017d343b01/5ee2713b64c4434a1fa0dbd3/5ef67886eb325278556737eb/1611460083464/bite-me-more-meet-lasagna.jpg?format=1500w' },
  { name: 'Burger', icon: 'ðŸ”', img: 'https://images.unsplash.com/photo-1568901346375-23c9450c58cd?q=80&w=500' },
  { name: 'Tacos', icon: 'ðŸŒ®', img: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTD-CUOhD5WqTgJIVDIjg40XOWKg4cf0rc56w&s' }
];

let activeFood = menuItems[0];
const world = document.getElementById('ar-world');
const sizeSlider = document.getElementById('sizeSlider');

// Initialize Camera
navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } })
  .then(s => document.getElementById('camera').srcObject = s);

// Build Premium Menu
const menuEl = document.getElementById('menu');
menuItems.forEach((item, index) => {
  const card = document.createElement('div');
  card.className = `food-card ${index === 0 ? 'active' : ''}`;
  card.innerHTML = `<div style="font-size:24px">${item.icon}</div><div style="font-weight:700">${item.name}</div><div class="stats">Halal</div>`;
  card.onclick = (e) => {
    e.stopPropagation();
    document.querySelectorAll('.food-card').forEach(c => c.classList.remove('active'));
    card.classList.add('active');
    activeFood = item;
    if(window.navigator.vibrate) window.navigator.vibrate(10); // Haptic feedback
  };
  menuEl.appendChild(card);
});

// Professional Motion Tracking
let b = 0, g = 0;
window.addEventListener('deviceorientation', (e) => {
  b = e.beta; g = e.gamma;
  // Smoothly rotate the world to counter phone movement
  world.style.transform = `rotateX(${-b}deg) rotateY(${-g}deg)`;
});

// Place Object Logic
window.addEventListener('click', (e) => {
  if (e.target.closest('#ui-bottom') || e.target.closest('#ui-top')) return;

  const container = document.createElement('div');
  container.className = 'dish-container';
  
  // Create Shadow
  const shadow = document.createElement('div');
  shadow.className = 'dish-shadow';
  
  // Create Image
  const img = document.createElement('img');
  img.src = activeFood.img;
  img.className = 'placed-dish';
  img.style.width = sizeSlider.value + 'px';

  container.appendChild(shadow);
  container.appendChild(img);

  // Position in 3D Space
  const x = window.innerWidth / 2 - (sizeSlider.value / 2);
  const y = window.innerHeight / 2 - (sizeSlider.value / 2);
  
  container.style.left = `${x}px`;
  container.style.top = `${y}px`;
  
  // Random depth and tilt to look realistic
  const zDepth = -600; 
  container.style.transform = `translateZ(${zDepth}px) rotateX(15deg)`;

  world.appendChild(container);

  // Haptic feedback on place
  if(window.navigator.vibrate) window.navigator.vibrate([20, 10, 20]);
});

function clearWorld() {
  world.innerHTML = '';
}
</script>
</body>
</html>
